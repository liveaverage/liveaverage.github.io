<!DOCTYPE HTML>

<html>
    <head>
        
            
                <title>Powershell: Bulk provision DHCP Scopes</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.18.1" />
        


        
            <meta name="author" content="JR">
        
        
            
        

        

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="Powershell: Bulk provision DHCP Scopes"/>
<meta name="twitter:description" content="Thought I&#8217;d share a nice wrapper for netsh and dnscmd calls to allow easy, bulk provisioning of new DHCP scopes. It&#8217;s nice being able to provision a ton of these at once by piping the output from Import-CSV!
&nbsp;
############################ #AUTHOR: JR Morgan #CREATED: 20120417 #MODIFIED: 20140611 ############################ &lt;# .Synopsis Adds DHCP Scope to ALL specified DHCP servers. If split-scope is desired the script uses IP Math to automatically add the desired exlcude ranges."/>



        <meta property="og:title" content="Powershell: Bulk provision DHCP Scopes" />
<meta property="og:description" content="Thought I&#8217;d share a nice wrapper for netsh and dnscmd calls to allow easy, bulk provisioning of new DHCP scopes. It&#8217;s nice being able to provision a ton of these at once by piping the output from Import-CSV!
&nbsp;
############################ #AUTHOR: JR Morgan #CREATED: 20120417 #MODIFIED: 20140611 ############################ &lt;# .Synopsis Adds DHCP Scope to ALL specified DHCP servers. If split-scope is desired the script uses IP Math to automatically add the desired exlcude ranges." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/features/coding/powershell-bulk-provision-dhcp-scopes/" />


<meta property="og:updated_time" content="2014-07-30T21:08:10&#43;00:00"/>










        
<meta itemprop="name" content="Powershell: Bulk provision DHCP Scopes">
<meta itemprop="description" content="Thought I&#8217;d share a nice wrapper for netsh and dnscmd calls to allow easy, bulk provisioning of new DHCP scopes. It&#8217;s nice being able to provision a ton of these at once by piping the output from Import-CSV!
&nbsp;
############################ #AUTHOR: JR Morgan #CREATED: 20120417 #MODIFIED: 20140611 ############################ &lt;# .Synopsis Adds DHCP Scope to ALL specified DHCP servers. If split-scope is desired the script uses IP Math to automatically add the desired exlcude ranges.">


<meta itemprop="dateModified" content="2014-07-30T21:08:10&#43;00:00" />
<meta itemprop="wordCount" content="223">



<meta itemprop="keywords" content="check_mk,coding,features,infrastructure-management,living,motorycles,nagios,news,powershell,backup,bash,dumps,mysql,perl-zimbra-zmprov-provisioning,script,shell,sql,victoria-lestz-wedding,wedding-of-victoria-lestz-and-jr-morgan," />

        

        

        
        
            
        

        
        
            <link rel="stylesheet" href="/css/google-font.css" />
            <link rel="stylesheet" href="/css/font-awesome.min.css" />
            <link rel="stylesheet" href="/css/main.css" />
            <link rel="stylesheet" href="/css/add-on.css" />
            <link rel="stylesheet" href="/css/monokai-sublime.css">
        

        

        
        
        
            
        
    </head>
    <body>

        
        <div id="wrapper">

    
    
<header id="header">
    
        <h2><a href="/"></i></a></h2>
    

    <nav class="links">
        <ul>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="q" value="site:http://example.org/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="q" value="site:http://example.org/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
            </ul>
        </section>

    
        <section>
            <ul class="links">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                
                    
                

                
                    <li>
                        <a href="http://example.org/features/infrastructure-management/check_mk-envrionmental-monitoring-room-alert-4e/"><p>Check_MK Environmental Monitoring: Room Alert 4E</p></a>
                    </li>
                
                    <li>
                        <a href="http://example.org/features/coding/making-cisco-identity-firewall-and-ise-play-nice/"><p>Making Cisco Identity Firewall, CDA, and ISE play nice</p></a>
                    </li>
                
                    <li>
                        <a href="http://example.org/features/coding/powershell-bulk-provision-dhcp-scopes/"><p>Powershell: Bulk provision DHCP Scopes</p></a>
                    </li>
                
                    <li>
                        <a href="http://example.org/features/coding/check_mk-local-checks-grab-bag/"><p>Check_MK: Local Checks Grab Bag!</p></a>
                    </li>
                
                    <li>
                        <a href="http://example.org/news/crystal-method-2014-orlando-firestone-live/"><p>EDM Legends: Crystal Method 2014 – Orlando @Firestone Live</p></a>
                    </li>
                
            </ul>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            


<li><a href="//twitter.com/share?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&text=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes&via=" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
</a></li>


<li><a href="//plus.google.com/share?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
</a></li>


<li><a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
</a></li>


<li><a href="//reddit.com/submit?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&title=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
</a></li>


<li><a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&title=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes" target="_blank" class="share-btn linkedin">
    <i class="fa fa-linkedin"></i>
    <p>LinkedIn</p>
</a></li>


<li><a href="//www.stumbleupon.com/submit?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&title=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
</a></li>


<li><a href="mailto:?subject=Check out this post by JR&body=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
</a></li>

        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
    <header>
    <div class="title">
        
            <h1><a href="http://example.org/features/coding/powershell-bulk-provision-dhcp-scopes/">Powershell: Bulk provision DHCP Scopes</a></h1>
            
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2014-07-30'>
            July 30, 2014</time>
        <span class="author">JR</span>
        
        
    </div>
</header>


    <section id="social-share">
        <ul class="icons">
            


<li><a href="//twitter.com/share?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&text=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes&via=" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
</a></li>


<li><a href="//plus.google.com/share?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
</a></li>


<li><a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
</a></li>


<li><a href="//reddit.com/submit?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&title=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
</a></li>


<li><a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&title=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes" target="_blank" class="share-btn linkedin">
    <i class="fa fa-linkedin"></i>
    <p>LinkedIn</p>
</a></li>


<li><a href="//www.stumbleupon.com/submit?url=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f&title=Powershell%3a%20Bulk%20provision%20DHCP%20Scopes" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
</a></li>


<li><a href="mailto:?subject=Check out this post by JR&body=http%3a%2f%2fexample.org%2ffeatures%2fcoding%2fpowershell-bulk-provision-dhcp-scopes%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
</a></li>

        </ul>
    </section>
    

    <div id="content">
        <p>Thought I&#8217;d share a nice wrapper for netsh and dnscmd calls to allow easy, bulk provisioning of new DHCP scopes. It&#8217;s nice being able to provision a ton of these at once by piping the output from Import-CSV!</p>

<p>&nbsp;</p>

<div class="code-embed-wrapper">
  <pre class="language-bash code-embed-pre line-numbers" ><code class="language-bash code-embed-code">############################
#AUTHOR:       JR Morgan
#CREATED:      20120417
#MODIFIED:     20140611
############################

&lt;#
    .Synopsis 
    Adds DHCP Scope to ALL specified DHCP servers. If split-scope is desired
    the script uses IP Math to automatically add the desired exlcude ranges.
    

    .Description 
    Creates a DHCP based on user-provided parameters. For 50/50 split-scope config,
    the ordering of the DHCP Servers determines the upper/lower designation. The first
    DHCP server specified will host upper scope portion, while the second DHCP server will
    host the lower scope portion. Upper/Lower &#039;tags&#039; are added to the description when using
    the Split50 switch.

    .Parameter DhcpServer
        An array of DHCP Server IP names or addresses that will host the new DHCP scopes
        
    .Parameter IPScope
        The desired IP Scope

    .Parameter IPMask
        The desired IP mask for the scope

    .Parameter Description
        A brief scope description. Upper/Lower tags will
        automatically be added if using the Split50 switch
    
    .Parameter Gateway
        The IP address of the router or gateway for this scope (Option 3)
    
    .Parameter Dns
        An array of DNS server IP addresses utilized by scope clients (Option 6).
    
    .Parameter Domain
        The fully-qualified domain name for scope clients (Option 15)</code></pre>
  
  <div class="code-embed-infos">
    <a href="https://gist.github.com/f61799a360039990087b" title="See Set-Dhcp-Scope.ps1" target="_blank" class="code-embed-name">Set-Dhcp-Scope.ps1</a> <a href="https://gist.githubusercontent.com/liveaverage/f61799a360039990087b/raw/11e25c9381428702a9fa23fd72a7debfc37b6f41/Set-Dhcp-Scope.ps1" title="Back to Set-Dhcp-Scope.ps1" class="code-embed-raw" target="_blank">view raw</a>
  </div>
</div>

    </div>

    <footer>
        <ul class="stats">
    
        

        
        
            <li>
                
    </footer>
</article>
<ul class="actions pagination">
    
        <li><a href="http://example.org/features/coding/check_mk-local-checks-grab-bag/"
                class="button big previous">Check_MK: Local Checks Grab Bag!</a></li>
    

    
        <li><a href="http://example.org/features/coding/making-cisco-identity-firewall-and-ise-play-nice/"
                class="button big next">Making Cisco Identity Firewall, CDA, and ISE play nice</a></li>
    
</ul>




    </div>
    
<section id="sidebar">

    
        <section id="intro">
            
            
            
            <ul class="icons">
                
                
            </ul>
        </section>

    
        <section id="recent-posts">
            <ul class="posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                
                    
                

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <h3><a href="http://example.org/features/infrastructure-management/check_mk-envrionmental-monitoring-room-alert-4e/">Check_MK Environmental Monitoring: Room Alert 4E</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2014-08-13'>
                                    August 13, 2014</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="http://example.org/features/coding/making-cisco-identity-firewall-and-ise-play-nice/">Making Cisco Identity Firewall, CDA, and ISE play nice</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2014-08-07'>
                                    August 7, 2014</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="http://example.org/features/coding/powershell-bulk-provision-dhcp-scopes/">Powershell: Bulk provision DHCP Scopes</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2014-07-30'>
                                    July 30, 2014</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="http://example.org/features/coding/check_mk-local-checks-grab-bag/">Check_MK: Local Checks Grab Bag!</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2014-07-29'>
                                    July 29, 2014</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="http://example.org/news/crystal-method-2014-orlando-firestone-live/">EDM Legends: Crystal Method 2014 – Orlando @Firestone Live</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2014-05-05'>
                                    May 5, 2014</time>
                            </header>
                        </article>
                    </li>
                

                
                    <li>
                        <ul class="actions">
                            <li><a href=
                            
                                "/post/"
                            
                            class="button">View more posts</a></li>
                        </ul>
                    </li>
                
            </ul>
        </section>

    
    
    
    
        <section id="categories">
            <ul class="posts">
                <header>
                    <h3><a href="/categories/">Categories</a></h3>
                </header>

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/check_mk/">check_mk</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/coding/">coding</a>
                                <span style="float:right;">12</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/features/">features</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/infrastructure-management/">infrastructure-management</a>
                                <span style="float:right;">12</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/living/">living</a>
                                <span style="float:right;">4</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/motorycles/">motorycles</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/nagios/">nagios</a>
                                <span style="float:right;">3</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/news/">news</a>
                                <span style="float:right;">16</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/powershell/">powershell</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
            </ul>
        </section>
    

    
        

    
        <section id="footer">
            <ul class="icons">
                
                
            </ul>

            <p class="copyright">&copy; My New Hugo Site. Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a>. Ported by <a href="//github.com/jpescador" target="_blank">Julio Pescador</a>. Powered by <a href="//gohugo.io" target="_blank">Hugo</a></p>
        </section>

</section>

            </div>
        <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
        

        
        
            
        

        
        
            <script src="/js/jquery.min.js"></script>
            <script src="/js/skel.min.js"></script>
            <script src="/js/util.js"></script>
            <script src="/js/main.js"></script>
            <script src="/js/backToTop.js"></script>
            <script src="/js/highlight.pack.js"></script>
        

        

            
            <script>hljs.initHighlightingOnLoad();</script>
            
    </body>
</html>

